# encoding=UTF-8
from flask import Flask, render_template, request, Response
from scraper import Scraper
import lottery
import csv_filter
import json
from config import google_api

app = Flask(__name__)

@app.after_request
def add_header(response):   # disabled cached when debugging
    response.cache_control.max_age = 1
    return response

@app.route('/')
def index():    # get html page
    return render_template('index.html', google_key=google_api.key)

@app.route('/scrapy', methods=['POST'])
def scrapy():     # post scrapy setting to backend
    req = request.get_json()       # get setting
    print(req)
    if 'comment_options' in req:    # if need comment
        comment_options = {         
            'TAGS': int(req['comment_options']['tag']),
            'TEXT': req['comment_options']['text']
        }
    else:                       # if dont need comment, set an empty comment_options
        comment_options = {
            'TAGS': 0,
            'TEXT': ""
        }            
    try:
        legal_list = Scraper(req['post_link'], comment_options, req['need_like']).run()
    except Exception as e:
        print("except:", e, "QQWTF")
        return str(e), 400
    # print(legal_list)
    # legal_list = [('Claire Wang', '/xiao.xu.315', 'ç°¡å¡å¼µç„Lee KevinBryan Hsaioè²¡ç®¡æ€ªäººå€‘å¿«ä¾†å¡«'), ('Claire Wang', '/xiao.xu.315', 'é™³å“å¦¤Hannah Hsuâ™¥ï¸'), ('Chung Fiona', '/chung.fiona.90', 'Hoi Ping GohHui YeeYi Qi Goh'), ('Chung Fiona', '/chung.fiona.90','ä½•ç‘„èŠ³å¿«åˆ©ç”¨ä½ å»£å¤§çš„äººè„ˆå“ˆå“ˆå“ˆ'), ('Claire Wang', '/xiao.xu.315', 'Chloe LinèŠç­‘èŒµè¨±çˆç¶­æ—å¿ƒç‘œç‹ç­ å©·å¹«å¿™å¡«å€‹ã„…ğŸ™'), ('Yvan Cai', '/yvan.cai.9', 'ç”Ÿç†æ€§åˆ¥ å¥³ç”Ÿè®Šé¸é …2'), ('ç‹å“äº‘', '/profile.php?id=100001701070269', 'é‚±å“å‹›å•å·æ˜¯ä¸æ˜¯æ”¾éŒ¯äº†'), ('é‚±å“å‹›', '/profile.php?id=100002458246114', 'é»ƒå½¥éˆè¨±æ™ºè¶…åº·éŠ˜æš ï¼ˆLouis Yangï¼‰å‘¨å“²å‰æ–½åŸå„’ ï¼ˆYin-Ju Shihï¼‰è¨±ä½³æš„é«˜è²å…’ ï¼ˆé«˜è²ï¼‰æé «åŠ‰æŸæ¯…è¨±ç­‘æ¶µ ï¼ˆHannah Hsuï¼‰å¿«ä¾†æ•‘æ•‘æˆ‘çš„æœŸæœ« å—šå—š ä¹Ÿç¥ä½ å€‘ä¸­ç!!!!'), ('é»ƒæ€æ–‡', '/profile.php?id=100003474270513', 'é™³æŸå®‰ é»ƒå­å¸­'), ('åº·éŠ˜æš', '/profile.php?id=100003364707234', 'è¨±æ™ºè¶… é»ƒå½¥éˆ æ˜Ÿå·´å…‹å–èµ·ä¾†'), ('Melvin Xuan', '/melvinxuan816', 'æ˜Ÿå·´å…‹å–èµ·ä¾† Claudia Tung Crystal Wee'), ('ç‹å“äº‘', '/profile.php?id=100001701070269', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é™³æ¯“çŠ å‘‚ä½³ç©'), ('å¼µè€åº­', '/paula.chang.222', 'æ˜Ÿå·´å…‹å–èµ·ä¾† è‘‰è« æ½”æå®¹è˜‹'), ('Chung Fiona', '/chung.fiona.90', 'KaHei Chuiå¼µç®æ…ˆå®¤å‹å€‘æ•‘æ•‘æˆ‘çš„æœŸæœ«â¤ï¸'), ('Chung Fiona', '/chung.fiona.90', 'Kelvin YapHowHow Jia JianTan Margin å°å¤§ä¸€å€‘å¹«å¿™å¡«å€‹ â¤ï¸'), ('æ—å¿ƒç‘œ', '/rhoda980224', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å³å¥•æŸ” è˜‡å­æ·³'), ('é™³å“æ½”', '/profile.php?id=100004430224605', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!é™³ä¿¡ç”« Cht Yang'), ('å¾è—åº­', '/xu.t.ting.7', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! æ—ä½™æŸ” è‘‰æ¥¹èŒ¹'), ('Chung Fiona', '/chung.fiona.90', 'Eva LaiKhor Yi YingTan Jou TingZyin ChoyRayne HohShiyuan Sy å¤§å®¶æœ‰ç©ºçš„è©±å¹«å¿™å¡«å–”'), ('Claire Wang', '/xiao.xu.315', 'è¬ç«£ç«¤é»ƒèŠç©å¾æ¹˜æ·‡æ–¹å°ç‘€å¾éƒæ·³å¹«æˆ‘å¡«ï½ï½ï½ï½ï½â¤ï¸'), ('æ—ä½³è', '/profile.php?id=100002739680101', 'å€ªèŠƒå®¥ åŠ‰æº¦æ´µ æ˜Ÿå·´å…‹å–èµ·ä¾†'), ('è¨±æ™ºè¶…', '/witty.hsu', 'æ˜Ÿå·´å…‹å–èµ·ä¾†ï¼é‚±å“å‹› å‘¨æ–°æ·³'), ('Crystal Ooi', '/jin0812', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ Tina Huang Athena Wong'), ('é™³å§¿åŸ', '/profile.php?id=100000528432603', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é™³æ€¡å®‰ è˜‡æ¢…å­'), ('ç‹å–¬å¥•', '/profile.php?id=100004299759970', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! é™³å®¥æ» è‘‰å½¥å¿—'), ('Claire Wang', '/xiao.xu.315', 'è”¡é›¨è¯æ±ªä½©ç’‡åº·è‚²èª Allan Chenï½ï½ï½'), ('Yvan Cai', '/yvan.cai.9', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! æ¥Šå½©æŸ”è¬è‚²çœŸå–å’–å•¡æ‰“å ±å‘Š'), ('Zyin Choy', '/Zyinchoy', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Ng Angie Lim Saw Yu'), ('å³èŠ¸å®‰', '/profile.php?id=100003081041782', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æå­£æŸ”åŠ‰èª¼å'), ('Weeyi Lim', '/weeyi.lim.1', 'Yimin Hsieh é‚±æ˜æ¬£'), ('Kelvin Yap', '/kelvinyapjk', 'æ˜Ÿå·´å…‹å–èµ·ä¾† Chey Siew Hui Yong Kai Wen'), ('é™³è© æ™´', '/profile.php?id=100003473812196', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Jo Yin Liaoé™³è© å›'), ('ä½•ç‘„èŠ³', '/profile.php?id=100001720903109', 'è”¡å–¬ç¾½ è”¡ç‘ç´˜ åŠ‰æ›¸å¦¤ ç°¡æ•¬å ‚ ææ€å„€ æéŠ˜ç¿° æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼å¹«å¹«æˆ‘å®¤å‹Chung Fionaçš„æœŸæœ«ğŸ™ğŸ™ğŸ™'), ('ç‹æ„æ¶µ', '/miffy.wang.50', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ¥Šæ™´å¿ƒ ç‹å“äº‘'), ('å²ç´”ç¿', '/ray.shih.54', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! ç‹æ˜“é”æ—ç®è»’'), ('Michael Wo', '/michael.wo.39','å¤§æ¨ç‰¹æ¨ å¾ä¸°æ¯“Judy Changæé «ç¾…äºå¸†ï½ï½ï½ï½'), ('Chung Fiona', '/chung.fiona.90', 'Sophie Ellen Vincent Tjoe guys please ask ur friends for help ğŸ˜„'), ('Weeyi Lim', '/weeyi.lim.1', 'Yimin Hsieh é‚±æ˜æ¬£æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('é™³ä¿¡æ°', '/profile.php?id=100001030551919', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!é™³å† äº‘é»ƒå‹‡èªŒ'), ('æ´ªæŒ¯æ—‚', '/alexpetertom', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! Jojo Chen è³´æ˜ ç«¹'), ('å¼µåšæ¶µ', '/profile.php?id=100004785340097', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Bryan Wang è‘‰å­Ÿæ˜€'), ('é™³æ¬£å¦¤', '/profile.php?id=100003493913557', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é»ƒæ¬£å„€é—•åƒè˜‹'), ('é»ƒéƒèŒ¹', '/yuju.huang.756', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† æ¥Šå²±ç‘¾é˜æ›¼ç¶¾'), ('è¨±åº­ç‘„', '/profile.php?id=100007970101021', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ æ›¹ç‘©ç‡ æ¥Šåšå‚‘'), ('é™³æ€¡å®‰', '/profile.php?id=100005487766723', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼è˜‡æ¢…å­ é™³å§¿åŸ'), ('æ¥Šå–¬èŒµ', '/profile.php?id=100000361832779', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! è‘‰æ˜ç‘œå­«é–åª›'), ('å¾æ¯“', '/yhsu2', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é»ƒé½¡è‘¦é»ƒå­åº­'), ('Lala Chi', '/profile.php?id=100004356125645', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é™³ä¿¡æ° æ—éŸ‹å²‘'), ('æ—äº­', '/profile.php?id=100001936611960', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é‡‘å–†ä¹‰ ç§¦æ˜Œæ…ˆ'), ('åŠ‰å† å±¥', '/profile.php?id=100009986258453', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! è‘‰æ˜ç‘œ å­«é–åª›'), ('Jia Yu Cheng', '/jiayu.cheng.5', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼èƒ¡é¦¨æ–‡é™³æ€è«ª'), ('é«˜å£«æ˜Œ', '/scott.kao.73', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ„·å®¸å¼µè˜‡æ™åŠ '), ('æ—éŸ‹å²‘', '/profile.php?id=100000474291276', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Lala Chi æ—å“è±'), ('Hoi Ping Goh', '/hoiping.goh', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼How Jia JianBeeKee Soon'), ('å³è²æ…§', '/profile.php?id=100002109118707', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ²ˆå®›è‡»å¤å­Ÿå›'), ('æ—ä½™æŸ”', '/yuzo8866', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å¾è—åº­ å‚…æœ‰è±'), ('è¨±ä½©çª', '/profile.php?id=100002511869301', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ¥Šé›…ç­‘Rita Yang'), ('How Jia Jian', '/jjhow17', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Terry Lee Anis Wong'), ('æ„·å®¸å¼µ', '/profile.php?id=100003804896982', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ è˜‡æ™åŠ  Kulas Isin'), ('æ—èŠ¯å¦˜', '/profile.php?id=100003728904355', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!æ½˜ç¾¿è¾° è¬æ²…æ²…'), ('ç°¡å¿—è»’', '/profile.php?id=100006113199773', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼è¨±ç¿æ©ç‹æ…ˆæ˜±'), ('å¼µç®æ…ˆ', '/yoolite','æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å½­æ¹˜æ™´ è‘‰æ´§å½¤'), ('è¬å®œæ†«', '/profile.php?id=100004056912711', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é‚±æ˜æ¬£ Chi Cheng'), ('å‘¨ç­ å®¹', '/profile.php?id=100002395696030', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ ä¸ç´«èŠ¸ è‘‰æ¬£'), ('é»ƒç­ é›…', '/profile.php?id=100002394356065', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!åŠ‰äº­å‡ä½•å­£è“‰'), ('å‘‚è±', '/arielluuu', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é»ƒå¿ƒç‘œ ä½™æ²å®¹'), ('Khor Yi Ying', '/yiying1219', 'Tan Jou Ting Zyin Choyæ˜Ÿå·´å…‹å–èµ·ä¾†'), ('Angel Hsu', '/angel.hsu.3591', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ æ—äºå¬› Sherlyn Tania'), ('é»ƒæŸéŠ˜','/pming1226', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é»ƒåƒå‡± ï¼ˆé»ƒæŸ¾æ³°ï¼‰ Jing Wen'), ('ç‹ç­ å©·', '/profile.php?id=100003148398913', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ—ä½©è±éƒæ›‰è¨€'), ('KaHei Chui', '/kahei.chui.5', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! é»ƒä¿Šç‘‹Wong Hoi Ian'), ('ç›§æ˜±å‡', '/yuchun.lu.5', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ æ—é¡¯å®— ç›§æ˜±ä½‘'), ('Jing Yang', '/profile.php?id=100002124153086', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ ææ±¶çˆé™³ä¿éœ'), ('Nancy Lu','/lu.nancy.1', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é™³æ¬ä½³ç¿è¨±æ–¹'), ('å¾ä¸°æ¯“', '/edward.hsu.1217', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† å³çŸ¥è€• é™³æ˜±æ„·'), ('ä½•æ€¡è±', '/chy880718', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼èŒƒé¦¨ä¹‹æ´ªå˜‰å›'), ('è”£å…¶å¡', '/ray.chiang.71', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ShaoYu Hsu æ¥Šå“è‘¦'), ('æ—æ—»', '/min.lin.50746', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! ç‹æ€å°¹æèŠ·å´´'), ('è‘‰æ˜è«º', '/mingyen.yeh.5', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! é™³å®´é¦¨æ±Ÿç¾æ¨º'), ('å‘¨ç¥ˆéˆ', '/profile.php?id=100009568613443', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼è‘‰é¦¨è¬å¼¦'), ('å¼µçš“éˆ', '/profile.php?id=100000703535228', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼å°¹å¯è¦ªå¾æ¨¹ç´…'), ('é«˜éˆºæƒ ', '/ivy19900503', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ¸¸å­é ¤éŒ¢ç‘‹'), ('è¬å·§ç³', '/profile.php?id=100000494577498','æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ Cheah Bei Yié»ƒé›ªç‘œ'), ('é™³æ€è«ª', '/cwendy830818', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ Jia Yu Cheng èƒ¡é¦¨æ–‡'), ('å•†å©•ç‘œ', '/jamie.shang.7', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é­èªæ¬£ å¾æ…•è–‡'), ('æ—å­Ÿç’‡', '/sherry.lin.896', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é„§é›…äº‘ é‚±è¯å¥•'), ('ç‹é›…ç³','/profile.php?id=100003541445645', 'é„­ä½‘ç‘©å‘¨è‘¦æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('é™³ç§€ç²', '/profile.php?id=100009155445602', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æœ±å­æ¶µ é™³ç««æ¶µ'), ('ä¸ç´«èŠ¸', '/uternalsummer', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† å‚…é–æ–‡ Hsun Hui Wang'), ('è˜‡å®¥å©•', '/profile.php?id=100000442011179', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ä½•æ€å¦˜å¼µç‘œå›'), ('é¡§é‡‡è–‡', '/profile.php?id=100003126297107', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! Tan Jia Shin Daisy Ho'), ('é™³å½¥ç©', '/profile.php?id=100003811547336', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! é—•ç®åº­ æ—ä¾‘è±'), ('Shiyuan Sy', '/shiyuan.sy', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! Annabelle Choo é»ƒé›ªç‘œ'), ('å¾éƒæ·³', '/profile.php?id=100000915669304', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é™³èŠå„€æ—æ¬£å„’'), ('å‘¨éŸ‹ä¼¶', '/weiling.zhou2', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Chou Yuhsun Tina Huang'), ('Annabelle Choo', '/annabellechooxl', 'ç‹å¦¤å¦‚ é„­ä¹‹æ¯“ æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('ç¾…äºå¸†', '/profile.php?id=100001466886832', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ Jack Lee å¼µä»¥è‡»'), ('é»ƒå¦å©·', '/profile.php?id=100004162204699', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é™³çª Athena Wong'), ('èŠç­‘èŒµ', '/profile.php?id=100000391609220', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†è‘‰è‡´å‡æ—æ€å¦¤'), ('æå®œç’‰', '/profile.php?id=100002701763522', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æé›¨ç’‡ è”¡ä¹‹å¯§'), ('é»ƒç¦¹æ™´', '/profile.php?id=100006165698298', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é»ƒéƒæ–‡é»ƒç¦è»’'), ('ä½™ä¿®èª ', '/profile.php?id=1329335195', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æä½³è”šæ¥Šå®—æ”¿'), ('å½­ä½³æ–‡', '/rizu1867', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ èŒƒé¦¨ä¹‹åŠ‰è•™æ¦• ï¼ˆCamille Liuï¼‰'), ('é™³æ˜±æ„·', '/profile.php?id=100002324028159', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† åŠ‰èª æ–°è˜‡è‡´ç‘‹ æˆ‘ä¹Ÿå¥½æƒ³åšå•å·ğŸ˜«'), ('æ–½åŸå„’', '/yinju.shih.3', 'Doneææ¬£å®¹è¬ä½³æ¨º'), ('è”¡å–œå–„', '/profile.php?id=100002436548346', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! ç‹å“äº‘ ç‹æ„æ¶µ'), ('ä¸å¸Œå½¤', '/claireting714', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†è¶™èŠ³ç‘€ç¾…å€©å¦‚'), ('é™³å½¥è¯', '/profile.php?id=100003491228030', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† æ¢æ°¸å¼· Yucheng James Chu'), ('è˜‡è˜‡', '/profile.php?id=100000350261939', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é™³å­Ÿç·¯éƒ­ä»¤ç‘œ'), ('å‘¨é‡‡ç‘„', '/profile.php?id=100002612675055', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼å…¨æ›¸äºHamber Chang'), ('å…¨æ›¸äº', '/profile.php?id=100003672586531', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†å‘¨é‡‡ç‘„ æ–¹éŸ»é›¯'), ('æ€ç©', '/zhong.ying.9', 'å‰ä»–ç¤¾æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ‹¯æ•‘æœŸæœ«å¤§ä½œæˆ°å“ˆå“ˆå“ˆé„­é›…äº‘è•­ä¼Šæ¶µæ—è‰é›¯æ—æ‰¿æ‡Œé‚±è‡´æŸ”æœ±å…‰æ„·Cindy LinåŠ‰ç‰å­Alex Yinæ´ªæŒ¯å‚‘ä¸é¡¯ç¿”å¾å­ç‘¤é‚„æœ‰å¥½å¤šäººå–”æ­¡è¿å¤§å®¶ä¾†æŠ½çï¼ï¼'), ('åŠ‰ç‰å­', '/profile.php?id=100004019411436', 'æ´ªæŒ¯å‚‘ æ—æ‰¿æ‡Œæ„Ÿè¬æˆ‘ã„…\næ˜Ÿå·´å…‹æŠ½èµ·ä¾†'), ('è‘‰æ´§å½¤', '/ye.zi.980', 'èƒ¡é¦¨å°¹å³æ˜±å¼˜æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('é‚±è‡´æŸ”', '/amy.chiu.125', 'æœ±æ˜“å®£å¼µæ–‡å§¿å¡«å•å·æ•‘å®¤å‹æ€ç©æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('æ¥Šæ­è±ª', '/sun.how.71', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å½­æ–‡äº­ ï¼ˆWenTing Pengï¼‰ å³æŸç©'), ('Hui Yee', '/Huiyee1998', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Zyin ChoyRuo Thung'), ('Tan Margin', '/tan.margin.7', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Duyen Vu ÄÃ o Anh Minh'), ('æ´ªæŒ¯å‚‘', '/profile.php?id=100000400612298', 'æå„ªç¾¤ æ—ç·¯ç¨‹ æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('Yi Qi Goh', '/yiqi.gohelf', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Hui Yee Hoi Ping Goh'), ('è¢å’ä»ª', '/jenny.g.jenny.3', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼BeeKee Soon Jo An'), ('Stacie Hsiao', '/stacie.hsiao', 'ç´€å¦¤å²«æ–½æ³¯å˜‰æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('ç´€å¦¤å²«', '/rumvu', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Stacie Hsiaoé‚±è–é›…'), ('Ruo Thung', '/ruo.tong', 'Eu Jing Fei Hoi Ping Gohæ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('æ¥Šæ™å©·', '/pa.zou.73', 'é»ƒé¡—è“ Sara Wu æ˜Ÿå·´å…‹æŠ½èµ·ä¾†'), ('é™³å½¥æ…ˆ', '/profile.php?id=100000586324433', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼åŠ‰åŒ—è¾°é¦¬å…ä¸­'), ('è”¡ä½³èŒœ', '/profile.php?id=100007083107521', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† Eric Ni åŠ‰å­çª'), ('æ¢è‰¦å°¤', '/profile.php?id=100002023988441', 'æ—å½¥å»· ææ²»è'), ('æ—å®œè±', '/sandylin.lin.92', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é»ƒå¤§ç‘‹ è¬å­Ÿæ…ˆ'), ('åŠ‰å“å©•', '/profile.php?id=100001432904325', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! æ±Ÿä½©èŠ¸ä½•ç¡¯æ¶µ'), ('é«˜å·§ç²', '/linda.kao.969', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!åŠ‰ç¹¡æ…ˆç‹ç‰å©•'), ('åŠ‰ç¹¡æ…ˆ', '/profile.php?id=100004122428050', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é«˜å·§ç² é»ƒå† ç©'), ('è©¹ç®æ¸', '/carol011629', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ ææ‰¿æ¨º Tsung Chen'), ('å³æ™ºç©', '/aaronlove1211', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼å¼µé›…æ¶µ å¼µé¦¨æ–‡'), ('é™³ä¼¯éœ', '/profile.php?id=100001309787880', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ Godest Wang é»ƒå“ç‘„'), ('é»ƒå“ç‘„', '/cheynehuang', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†! æ¸¸çš“éˆæ—å‹‰'), ('è•­å­å‹¤', '/profile.php?id=100000359172345', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å®‹å¼˜è»’å¼µéƒæ€œ'), ('é™³å·§è“‰', '/ysesst95182', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Bryson Caw æœ±å°¹äº˜'), ('é™³å“å©•', '/jessicayoya', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼Jacky Huangææ¢“ç¿”'), ('é„­æ·¨ä¼ƒ', '/profile.php?id=100006362441315', 'å¾ç¶­å‹µ æ–½ç‘€å«ºæ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('ç‹å‰åŠ›', '/godest.wang', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ äºå…¶å¼˜ å‘¨ä¿å»·'), ('Shu Lian', '/shu.lian.5', 'Hong DaTan Jia Shin æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('Tan Jia Shin', '/tan.jiashin', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å“æ¡ é¾è© å€«'), ('ç‹æ³“è© ', '/profile.php?id=100001694300374', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾† æ—éŸ‹å²‘ åŠ‰ç´˜èˆ‡'), ('ææ˜€', '/profile.php?id=100003402272483', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é™³æ˜• å¼µçˆæ¼©'), ('å¼µèŠ³ç‘„', '/1997jennie', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ è¨±æ±æº¢ é®‘å¨å®‡'), ('é»ƒèªè±', '/profile.php?id=100002916605910', 'é»ƒæµ©ç‘€ é™³å®œæ¶µ æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!'), ('èŒƒç‘œåº­', '/tina1226tina', 'é™³å¥å› å³å¿µè“ æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('å³å¿µè“', '/profile.php?id=100000594528788', 'å¤æ¬£ç’‡å¼µæ¦›èŠ¸æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('æé§ç¢©', '/ken.lee.1884', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼é¦¬æ„·è¾°æ´ªå°¹è¬™'), ('é«˜æ…§å›', '/profile.php?id=100013876578152', 'é™³æ˜±è‡» ç‹æ‡¿æŸ” æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('è”¡æ™ºä¼ƒ', '/profile.php?id=100000369982431', 'é»ƒå¦‚éœœæœ±ç¿Œç”„æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('æ±ŸèŠ³ç‘œ', '/profile.php?id=100002598245297', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼éƒ­æ²›è± é™³å“ç’‡'), ('GloryLiang', '/glory.liang.9', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼è¨±ç¶ºçŠ é»ƒéƒèŒ¹'), ('æ„·æ¬£', '/AdelineTin1205', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é¾è© å€« Yong Kai Wen'), ('é‚±æ˜æ¬£', '/profile.php?id=100003615537778', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†!Yimin HsiehChi Cheng'), ('æ—æ¬£å„’', '/profile.php?id=100003302436199', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼éƒ­å˜‰èŒµ é™³éŸ‹å›'), ('é™³å¥•å›', '/199526pig', 'è˜‡æ¯“æ¶µå¾è‹¥åº­æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('å³æ©åº­', '/enting.wu1', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é¡äºå‚‘å³æ©åº­'), ('è˜‡æ¯“æ¶µ', '/katie.sue.940', 'é™³å¥•å›å¾è‹¥åº­æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('ææ˜±è±', '/profile.php?id=100002037107245', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ é­å®¶ç³ é—œé›…æ–‡ ï¼ˆMaggie Guanï¼‰'), ('ç¾…æ­†ç‘œ', '/pluviophilerusty', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼ å¼µåšæ¶µ ï¼ˆTeresa Changï¼‰ç‹æ¡‚èŠ³'), ('ç”°ä½³æ¬£', '/HaHaApril999', 'éƒ­å­ç¦ æ¹¯èŠ¸è—» æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('é™³æ½”æ…§', '/profile.php?id=100003653177937', 'Paula Liao è¬ç¾½è“æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼'), ('ç‹æ¡‚èŠ³', '/profile.php?id=100002846095042', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼å¼µåšæ¶µ ç¾…æ­†ç‘œ'), ('å¼µé›…æ·‡', '/vicky.chang.1048', 'æ˜Ÿå·´å…‹æŠ½èµ·ä¾†ï¼æ—æ²›ç‘© è¨±å®¶è±')]
    
    if 'csv_options' in req:
        options = req['csv_options']
        index = 0 if options['type']=="name" else 1
        legal_list = csv_filter.run(options['data'], index, legal_list)

    legal_list = [ {'name': d[0], 'url': d[1], 'comment': d[2]} for d in legal_list ]   # cast to json
    print(legal_list)
    return Response(json.dumps(legal_list),  mimetype='application/json')

@app.route('/lottery', methods=['POST'])
def get_lottery():
    req = request.get_json()
    try:
        winner = lottery.run(req['prize'], req['legal_list'])
        return Response(json.dumps(winner),  mimetype='application/json')
    except KeyError:
        return "è«‹å…ˆçˆ¬å–ä¸­çåå–®ï¼", 400

@app.route('/test')
def apptest():
    return render_template('test.html')

if __name__ == "__main__":
    app.config['ENV'] = "development"
    app.config['DEBUG'] = True
    app.run(port=3000)